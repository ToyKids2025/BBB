<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#32CD32" />
    <meta name="description" content="BuscaBusca Brasil - Encontre os melhores pre√ßos e ofertas. Sistema de links inteligentes com economia garantida." />

    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="BuscaBusca">

    <!-- iOS Icons (ordem espec√≠fica para m√°xima compatibilidade) -->
    <link rel="apple-touch-icon" sizes="180x180" href="%PUBLIC_URL%/icon-180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="%PUBLIC_URL%/icon-167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="%PUBLIC_URL%/icon-152.png">
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/icon-180.png" />

    <!-- PWA Manifest -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />

    <!-- Performance Optimizations -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://bbbrasil.com">

    <!-- SEO -->
    <meta property="og:title" content="BBB Link Enhancer Premium">
    <meta property="og:description" content="Sistema inteligente de recupera√ß√£o de comiss√µes de afiliados">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://admin.bbbrasil.com">
    <meta property="og:image" content="%PUBLIC_URL%/og-image.png">
    <meta name="twitter:card" content="summary_large_image">

    <title>BBB Link Enhancer Premium</title>

    <script>
        // üî• FIX ERRO 494: Limpeza for√ßada de cache ap√≥s otimiza√ß√£o
        (function() {
            const CACHE_VERSION = 'v4_clean_494'; // Vers√£o p√≥s-fix erro 494
            const lastCacheClean = localStorage.getItem('cache_clean_version');

            if (lastCacheClean !== CACHE_VERSION) {
                console.log('üßπ Limpando cache antigo (fix erro 494)...');

                // 1. Limpar Service Worker caches
                if ('caches' in window) {
                    caches.keys().then(function(names) {
                        names.forEach(function(name) {
                            console.log('Deletando cache:', name);
                            caches.delete(name);
                        });
                    });
                }

                // 2. Limpar localStorage de tracking antigo
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (
                        key.startsWith('bb_') ||
                        key.startsWith('cookie_') ||
                        key.includes('fingerprint') ||
                        key.includes('eternal') ||
                        key.includes('tracking')
                    )) {
                        keysToRemove.push(key);
                    }
                }
                keysToRemove.forEach(key => {
                    console.log('Removendo localStorage:', key);
                    localStorage.removeItem(key);
                });

                // 3. Limpar sessionStorage
                sessionStorage.clear();

                // 4. Marcar limpeza como conclu√≠da
                localStorage.setItem('cache_clean_version', CACHE_VERSION);
                console.log('‚úÖ Cache limpo! P√°gina ser√° recarregada.');

                // 5. Recarregar p√°gina para garantir vers√£o limpa
                setTimeout(function() {
                    window.location.reload(true); // Hard reload
                }, 500);
            }
        })();

        // Service Worker √∫nico ser√° registrado via src/index.js
        // N√£o registrar aqui para evitar conflitos

        // Pixel tracking inicial (ap√≥s DOM carregar)
        window.addEventListener('DOMContentLoaded', function() {
            const pixel = new Image(1, 1);
            pixel.src = 'https://buscabuscabrasil.com.br/p.gif?event=page_load&t=' + Date.now();
            pixel.style.display = 'none';
            if (document.body) {
                document.body.appendChild(pixel);
            }
        });
    </script>
</head>
<body>
    <noscript>Voc√™ precisa habilitar o JavaScript para usar este aplicativo.</noscript>
    <div id="root"></div>
</body>
</html>